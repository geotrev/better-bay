// ==UserScript==
// @name        Super Bay - Feedback
// @description Automate feedback on ebay
// @namespace   https://github.com/geotrev/super-bay
// @version     1.0.14
// @author      George Treviranus
// @run-at      document-idle
// @match       https://www.ebay.com/fdbk/leave_feedback*
// @downloadURL https://github.com/geotrev/super-bay/raw/main/dist/feedback.user.js
// @updateURL   https://github.com/geotrev/super-bay/raw/main/dist/feedback.user.js
// @grant       none
// ==/UserScript==
!function(){"use strict";const e=new class{constructor(){const e=document.createElement("div"),t=document.createElement("div");e.innerHTML='<div style="position: fixed;top: 0px;right: 0px;bottom: unset;left: 0px;z-index: 4000;padding: 48px 16px;pointer-events: none;display: flex;flex-direction: column;align-items: flex-end;"></div>',t.innerHTML='<section role="region" style="pointer-events: auto;flex-wrap: wrap;background-color: #333;margin: 0px;color: #dedede;padding: 12px 16px;border-radius: 8px;max-width: 280px;box-shadow: 0 5px 10px rgba(0,0,0,0.5);margin-bottom: 12px;"><h3 style="margin-bottom: 8px;margin-top:0;padding: 0;font-weight: bold;font-size: 12px;">[Super Bay]</h3><p style="font-size: 16px;line-height: 22px;padding: 0;margin:0;" data-notify-content></p></section>',this.notifyWrapper=e.firstElementChild,this.notifyEl=t.firstElementChild,document.body.appendChild(this.notifyWrapper),this.destroy=this.destroy.bind(this)}trigger({content:e}){const t=this.notifyEl.cloneNode(!0);t.querySelector("p").innerText=e,this.notifyWrapper.appendChild(t),setTimeout(this.destroy,2e3)}destroy(){this.notifyWrapper.removeChild(this.notifyWrapper.firstElementChild)}};let t=!1;const n={DEBUG:!1,SALE_FEEDBACK_TEXT:"Great buyer + fast payment. Thanks.",PURCHASE_FEEDBACK_TEXT:"Easy purchase + item arrived as described. Thanks."};function i(e,t){return t>1?e+"s":e}function o(o){if(!window.location.pathname.startsWith("/fdbk/leave_feedback")||t||!["f","F"].includes(o.key)||!o.altKey||!o.shiftKey)return;o.ctrlKey&&(n.DEBUG=!0),t=!0;let r=0,c=0;const l=document.querySelectorAll(".single-feedback-template"),a=l.length;if(0===a)return t=!1,e.trigger({content:"No feedback, exiting."});function s(e){e.dispatchEvent(new Event("blur"))}e.trigger({content:"Filling feedback..."});for(let e=0;e<a;e++){const t=l[e];if(t.textContent.indexOf("Sold By")>-1){const e=t.querySelector('input[value="2"][name^="ON_TIME_DELIVERY"]');e&&e.click();const i=t.querySelector('input[value="POSITIVE"][name^="OVERALL_EXPERIENCE"]');i&&i.click();const o=t.querySelector('input[value="5"][name^="DSR_ITEM_AS_DESCRIBED"]');o&&o.click();const c=t.querySelector('input[value="5"][name^="DSR_SHIPPING_CHARGES"]');c&&c.click();const l=t.querySelector('input[value="5"][name^="DSR_SHIPPING_TIME"]');l&&l.click();const a=t.querySelector('input[value="5"][name^="DSR_COMMUNICATION"]');a&&a.click();const d=t.querySelector('textarea[name="OVERALL_EXPERIENCE_COMMENT"]');d&&(d.value=n.PURCHASE_FEEDBACK_TEXT,s(d)),r+=1}else if(t.textContent.indexOf("Purchased by")>-1){const e=t.querySelector('input[value="POSITIVE"][name^="OVERALL_EXPERIENCE"]');e&&e.click();const i=t.querySelector('input[name="OVERALL_EXPERIENCE_COMMENT"]');i&&(i.value=n.SALE_FEEDBACK_TEXT,s(i)),c+=1}}if(!n.DEBUG){const e=document.querySelectorAll('button[id^="submitFeedbackBtn-"]');e.length&&e.forEach((e=>!e.disabled&&e.click()))}r>0&&e.trigger({content:`Feedback completed for ${r} ${i("seller",r)}.`}),c>0&&e.trigger({content:`Feedback completed for ${c} ${i("buyer",c)}.`}),t=!1}e.trigger({content:"Plugin activated! Press Alt+Shift+F to fill out feedback."}),document.addEventListener("keydown",o)}();
